\chapter{Hartree-Fock Theory} 

    In 1927, soon after the discovery of the Schrödinger equation in 1926, Douglas R.
    Hartree introduced a procedure which he called the self-consistent field 
    method\cite{hartree1928wave}. 
    Hartree sought to do without empirical parameters and
    to solve the many-body time-independent Schrödinger equation from fundamental
    principles, \emph{ab initio}. A year later John C. Slater and John A. Gaunt 
    provided a sounder theoretical basis for the Hartree method by applying the 
    variational principle to a trial wave function as a product of single-particle
    functions\cite{slater1928self}\cite{gaunt1928theory}. 
    Slater later pointed out, with support from Vladimir A. Fock, that the method
    merely applied the Pauli exclusion principle in its older, incorrect formulation;
    forbidding presence of two electrons in the same state, but neglecting 
    quantum statistics\cite{slater1930note}\cite{fock1930naherungsmethode}. It was
    shown that a Slater determinant satisfies the antisymmetric property of the
    exact solution and would be a suitable ansatz for applying the variational
    principle. Later, Hartree reformulated the method for 
    calculation\cite{hartree1935self}.

    The Hartree-Fock methods makes the following simplications to the multi-electron 
    atomic (molecular) problem,
    \begin{itemize}
        \item The full molecular wavefunction is contrained to a function of the
            coordinates of only the electrons in the molecule. In not so many words,
            the Born-Oppernheimer approximation is inerent in the method.
        \item Any relativistic effects are completely ignored, i.e. the momentum
            operator is assumed to be completely non-relativistic.
        \item A variational solution is assumed to be a linear combination of a basis
            set, which is assumed to be approximately complete. This set of basis
            functions is usually orthogonal, but may not be. 
        \item Some electron correlation effects are ignored, as the methods implies
            a mean-field approximation. Coulomb correlation is fully incorporated 
            in the Hartree-Fock method, but it ignores Fermi Correlation and is
            therefore inable to describe some effects, like London 
            dispersion\footnote{Named after Fritz London; London dispersion
            forces (LDF) are a type of force between atoms and 
            molecules\cite{heitler1927wechselwirkung}}.
        \item Any energy eigenfunction is assumed to be describable by a single 
            Slater determinant. 
    \end{itemize}

    Relaxation of the last two simplifications give rise to the large group of
    many-body methods commonly referred to as post-Hartree-Fock methods. 

    \section{Deriving the Hartree-Fock Equations}

    Consider a Hamiltionian for some system
    \begin{equation}
        \label{eq:hf_hamiltonian}
        \hat{H} = \hat{H}_0 + \hat{W}, \quad \hat{H}_0 = \sum_i^N \hat{h}(i),
    \end{equation}
    where the ground state of $\hat{H}_0$ is a Slater determinant consisting 
    of $N$ single-particle functions,
    \begin{equation}
        \Phi = \mathscr{A}\phi_1 \phi_2 \dots \phi_N, \quad 
            \braket{\phi_i}{\phi_j} = \delta_{ij}.
    \end{equation} 
    If $\hat{W}$ is 
    only a limited perturbation to the system, it is reasonable to assume that the 
    actual ground state of the full system can also be represented by a Slater 
    determinant. Because the Hartree-Fock theory includes a mean-field approximation,
    each particle moves independently of the others interacting with the remainding
    electrons only idirectly through an average potential $\hat{v}^{\text{HF}}$.

    The expectation value of the Hamiltionian in \autoref{eq:hf_hamiltonian} is 
    \begin{equation}
        \label{eq:hf_energy}
        \bra{\Phi} \hat{H} \ket{\Phi} 
            = \sum_i \bra{\phi_i} \hat{h} \ket{\phi_i}
            + \frac{1}{2} \sum_{ij} \bra{\phi_i \phi_k} \hat{w} 
                \ket{\phi_i \phi_j - \phi_j \phi_i},
    \end{equation}
    where 
    \begin{equation*}
        \bra{\phi_i \phi_j} \hat{w} \ket{\phi_k \phi_l}
         = \int \int \bar{\phi}_i(1) \bar{\phi}_j(2) 
            \hat{w}(1, 2) \phi_k(1) \phi_l(2) d1 d2
    \end{equation*}

    Now we want to minimise the energy (\autoref{eq:hf_hamiltonian}) under the
    contraint of orthonormal single-particle functions, id est
    $\braket{\phi_i}{\phi_k} = \delta_{ij}$. The minimum solution is called the 
    Hatree-Fock state, $\ket{\Phi_{\text{HF}}}$. An optimisation problem with a 
    constraint begs the formualtion of a Lagrangian functional with a Lagrange
    multiplier for each constraint,
    \begin{equation}
        \label{eq:hf_lagrangian}
        \begin{aligned}
        \mathscr{L}(\phi_1, &\dots, \phi_n, \lambda)
            = \bra{\Phi} \hat{H} \ket{\Phi} 
                - \sum_{ij}\lambda_{ij}(\braket{\phi_i}{\phi_j} - \delta_{ij}) \\
            &= \sum_i \bra{\phi_i} \hat{h} \ket{\phi_i}
                + \frac{1}{2}\sum_{ij} \bra{\phi_i \phi_j} 
                    \hat{w} \ket{\phi_i \phi_j -  \phi_j \phi_i}
                - \sum_{ij} \lambda_{ij} (\braket{\phi_i}{\phi_j - \delta_{ij}}).
        \end{aligned}
    \end{equation}

    The constraints can always be treated separately, 
    $\partial \mathscr{L}/\partial \lambda_{ij} \braket{\phi_i}{\phi_j} - \delta_{ij}$,
    as this demand will be fullfilled by finding that the solutions $\phi_i$ are 
    orthonormal.

    In order to find the optimum of the Lagrangian in (\autoref{eq:hf_lagrangian}),
    we choose a $k \in \{1, \dots, N \}$ and compute the directional derivative of
    $\phi_k^*$, by varying this single particle function and leaving all others fixed,
    \begin{equation}
        \delta \phi_k = \epsilon \eta, \quad \delta \phi_l = 0, k \neq l,
    \end{equation}
    where $\epsilon$ is some small number, and $\eta$ is a normalized single-particle 
    function. We define a function representing this variation,
    \begin{equation}
        \label{eq:variation_hf_lagrangian}
        f(\epsilon) = \mathscr{L} (\phi_1, \dots, \phi_k + \epsilon \eta,
            \dots, \phi_N, \lambda),
    \end{equation}
    expanded to first order in $\epsilon$,
    \begin{equation}
        f(\epsilon) = f(0) + \epsilon f'(0) + \mathscr{O}(\epsilon^2).
    \end{equation}
    For an optimum we must have 
    \begin{equation}
        f'(0) = 0, \quad \forall \eta,
    \end{equation}
    which means that the directional derivative of $\mathscr{L}$ at 
    $\{\phi_i\}_{i=1}^N$, in the direction $\eta$ vanishes.

    We compute the Taylor expansion of the varied Lagrangian
    (\autoref{eq:variation_hf_lagrangian}),
    \begin{gather}
        \begin{gathered}
            f(\epsilon) =
            \sum_i \bra{\phi_i + \delta_{ki}\epsilon\eta} \hat{h} \ket{\phi_i}
            + \frac{1}{2} \sum_{ij} 
            \bra{(\phi_i + \delta_{ki}\epsilon\eta)(\phi_j + \delta_{kj}\epsilon\eta)}
            \hat{w} \ket{\phi_i\phi_j - \phi_j\phi_i} \\
            - \sum_{ij} \lambda_{ij} (\bra{\phi_i + \delta_{ik} \epsilon\eta}
                \ket{\phi_j} - \delta_{ij}) + \mathscr{O}(\epsilon^2)
        \end{gathered} \\
        \quad 
        \begin{gathered}
            =
            \sum_i \bra{\phi_i} \hat{h} \ket{\phi_i} 
                + \frac{1}{2} \sum_ij \bra{\phi_i \phi_j} \hat{w} 
                    \ket{\phi_i \phi_j - \phi_j \phi_i}
                + \epsilon\bra{\eta} \hat{h} \ket{\phi_k} \\
            + \frac{1}{2} \sum_{ij}\bra{\phi_i\delta_{kj}\epsilon\eta}\hat{w}
                \ket{\phi_i\phi_j - \phi_j\phi_i} \\
            + \frac{1}{2} \sum_{ij}\bra{\delta_{ki}\epsilon\eta\phi_j}\hat{w} 
                \ket{\phi_i\phi_j - \phi_j\phi_i} \\
            - \sum_{ij} \lambda_{ij}(\braket{\phi_i}{\phi_j} - \delta_{ij})
            - \sum_{ij} \lambda_{ij}(\braket{\delta_{ik}\epsilon\eta}{\phi_j} - \delta_{ij})
                + \mathscr{O}(\epsilon^2)
        \end{gathered} \\
        \quad
        \begin{gathered}
            =
            \sum_i \bra{\phi_i} \hat{h} \ket{\phi_i} 
            + \frac{1}{2} \sum_ij \bra{\phi_i \phi_j} \hat{w} 
                    \ket{\phi_i \phi_j - \phi_j \phi_i}
            + \epsilon\bra{\eta} \hat{h} \ket{\phi_k}
            - \sum_{ij}\lambda_{ij}(\braket{\phi_i}{\phi_j} - \delta_{ij}) \\
            + \frac{1}{2} \epsilon \sum_i \bra{\phi_i\eta} \hat{w}
                \ket{\phi_i \phi_k}
            - \frac{1}{2} \epsilon \sum_i \bra{\phi_i\eta} \hat{w}
                \ket{\phi_k \phi_i} \\
            + \frac{1}{2} \epsilon \sum_j \bra{\eta\phi_j} \hat{w}
                \ket{\phi_k \phi_j}
            - \frac{1}{2} \epsilon \sum_j \bra{\eta\phi_j} \hat{w}
                \ket{\phi_j \phi_k} \\
            - \epsilon \sum_j \lambda_{jk}\braket{\eta}{\phi_j}
            + \mathscr{O}(\epsilon^2) 
        \end{gathered} \\
        \quad
        \begin{gathered}
            \label{eq:hf_taylor_exp}
            =
            \sum_i \bra{\phi_i} \hat{h} \ket{\phi_i} 
            + \frac{1}{2} \sum_ij \bra{\phi_i \phi_j} \hat{w} 
                    \ket{\phi_i \phi_j - \phi_j \phi_i}
            - \sum_{ij}\lambda_{ij}(\braket{\phi_i}{\phi_j} - \delta_{ij}) \\
            + \epsilon\bra{\eta} \hat{h} \ket{\phi_k}
            + \epsilon \sum_i \bra{\eta\phi_i} \hat{w} \ket{\phi_k \phi_i}
            - \epsilon \sum_i \bra{\eta\phi_i} \hat{w} \ket{\phi_i \phi_k} \\
            - \epsilon \sum_j \lambda_{jk}\braket{\eta}{\phi_j}
            + \mathscr{O}(\epsilon^2) 
        \end{gathered}
    \end{gather}

Notice that the zeroth term, represented by the first line in \autoref{eq:hf_taylor_exp},
is simply the original Lagrangian in \autoref{eq:hf_lagrangian}. We equate all the 
first-order terms to zero,
\begin{equation}
    \bra{\eta} \hat{h} \ket{\phi_k} 
    + \sum_i \bra{\eta \phi_i} \hat{w} \ket{\phi_k\phi_i}
    - \sum_i \bra{\eta \phi_i} \hat{w} \ket{\phi_i\phi_k}
    - \sum_i \lambda_{ik} \braket{\eta}{\phi_i} = 0.
\end{equation}
This must be valid for any choice $\eta$, meaning
\begin{equation}
    \label{eq:unfinished_hf_eqn}
    \hat{h} \ket{\phi_k} 
    + \sum_i \bra{\cdot\ \phi_i} \hat{w} \ket{\phi_k\phi_i}
    - \sum_i \bra{\cdot\ \phi_i} \hat{w} \ket{\phi_i\phi_k}
    - \sum_i \lambda_{ik} \ket{\phi_i} = 0,
\end{equation}
where $\bra{\cdot\ \phi_1} \hat{w} \ket{\phi_2 \phi_3} \in L_1^2$ is interpreted
as an integral over only the second particle in the matrix element. We define,
\begin{gather}
    \hat{v}_{\text{HF}} = \hat{v}_{\text{direct}} + \hat{v}_{\text{exchange}}
        =\sum_i \bra{\cdot\ \phi_i} \hat{w} \ket{\phi_k\phi_i}
        -\sum_i \bra{\cdot\ \phi_i} \hat{w} \ket{\phi_i\phi_k} \\
    \hat{f} = \hat{h} + \hat{v}_{\text{HF}},
\end{gather}
and can then rewrite \autoref{eq:unfinished_hf_eqn} to 
\begin{equation}
    \label{eq:noncanonical_hf_eqns}
    \hat{f}\ket{\phi_i} = \sum_j \lambda_{ij}\ket{\phi_j},
\end{equation} 
which are the non-canonical Hartree-Fock equations.

It so happends that the Slater dertminant $\ket{\Phi}$ is invariant under unitary
transformation of the single particle functions. Consider
\begin{equation}
    \tilde{\phi}_k = \sum_j \phi_j U_{jk},
\end{equation}
where $U$ is a unitary matrix. This implies that $\ket{\tilde{\Phi}} = \det(U)\ket{\Phi}$,
is the same state and the energy must be the same as well. We choose a particular
unitary transformation $U$, rotating the single particle functions in a certain 
manner so that $\lambda = UEU^H$, where $E_{jk} = \delta_{jk}\epsilon_k$ are the 
elemnets of a diagonal matrix (the eigenvalues of $\lambda$). This provides us with 
a new set of eigenvalue equations,
\begin{equation}
    \label{eq:canonical_hf_eqns}
    \hat{f}(\tilde{\phi}_1, \dots, \tilde{\phi}_N)\ket{\tilde{\phi}_i}
        = \epsilon_i \ket{\tilde{\phi}_i},
\end{equation}
which are the canonical Hartree-Fock equations. From now on we will stick with these 
equations and suppress the tilde notations.

\section{The Roothan-Hall Equations}

In order to solve the Hartree-Fock equations (\autoref{eq:canonical_hf_eqns}) we 
render the equations in a finite, fixed basis $\{\chi_p \}_{p=1}^L$ of a finite 
size $L$. It is not a necessity for this basis to be orthonormal, and we therefore 
define the overlap matrix,
\begin{equation}
    S_{pq} \equiv \braket{\chi_p}{\chi_q}.
\end{equation}

The Hartree-Fock single-particle functions are expanded in this basis,
\begin{equation}
    \label{eq:roothan_hall_exp}
    \ket{\phi_p} = \sum_q \ket{\chi_q} U_{qp},
\end{equation}
where $U$ is not necessarily unitary, because the basis is not necessarily 
orthongonal. However, we do have $U^HSU = \hat{1}$.

We insert the expansion from \autoref{eq:roothan_hall_exp} into the expression 
for the canonical Hatree-Fock equations from \autoref{eq:canonical_hf_eqns},
\begin{equation}
    \hat{f}\sum_r \ket{\chi_r} U_{rp} = \epsilon_p \sum_r \ket{\chi_r} U_{rp}.
\end{equation}
Then we left project with an arbitrary function from our new basis,
\begin{equation}
    \begin{gathered}
        \bra{\chi_q} \hat{f} \sum_r \ket{\chi_r} U_{rp}
            = \epsilon_r \braket{\chi_q}{\chi_r} \sum_r U_{rp}\ \forall q,p \\
        \sum_r F_{qr} U_{rp} = \epsilon_r \sum_r S_{qr} U_{rp}\ \forall q,p \\
        F(D) U = S U \epsilon.
    \end{gathered}
\end{equation}
where the last line is the Roothan-Hall equations.

Elaborating on the computation of the Fock matrix element,
\begin{equation}
    F_{qp} = \bra{\chi_q} \hat{f} \ket{\chi_p}
        = \bra{\chi_q} \hat{h} \ket{\chi_p} 
        + \bra{\chi_q} \hat{v}_{\text{direct}} \ket{\chi_p}
        - \bra{\chi_q} \hat{v}_{\text{exchange}} \ket{\chi_p},
\end{equation}
where
\begin{align}
    &\begin{gathered}
    \bra{\chi_q} \hat{v}_{\text{direct}} \ket{\chi_p}
        = \sum_j \bra{\chi_q \phi_j} \hat{w} \ket{\chi_p \phi_j} 
        = \sum_{p'q'j} U_{jq'} U^*_{jp'} 
            \bra{\chi_q \chi_{q'}} \hat{w} \ket{\chi_p \chi_{p'}} \\
        = \sum_{p'q'} D_{p'q'} \bra{\chi_q \chi_{q'}} \hat{w} \ket{\chi_p \chi_{p'}}
    \end{gathered} \\
    &\begin{gathered}
    \bra{\chi_q} \hat{v}_{\text{exchange}} \ket{\chi_p}
        = \sum_j \bra{\chi_q \phi_j} \hat{w} \ket{\phi_j \chi_p} 
        = \sum_{p'q'j} U_{jq'} U^*_{jp'} 
            \bra{\chi_q \chi_{q'}} \hat{w} \ket{\chi_{p'} \chi_p} \\
        = \sum_{p'q'} D_{p'q'} \bra{\chi_q \chi_q'} \hat{w} \ket{\chi_p' \chi_p},  
    \end{gathered}
\end{align}
giving us,
\begin{equation}
    F_{qp} = \bra{\chi_q}\hat{h} \ket{\chi_p} 
        + \sum_{p'q'}D_{p'q'}(
            \ket{\chi_q\chi_{q'}}\hat{w} \ket{\chi_p\chi_{p'}}
            - \ket{\chi_q\chi_{q'}}\hat{w} \ket{\chi_{p'}\chi_p}
        ),
\end{equation}
where $D = UU^H$, is the density matrix.

The benefit of the Roothan-Hall equations (\autoref{eq:roothan_hall_exp}), is that they 
are represented by matrices, and therefore easy to implement on a computer. The
Roothan-Hall equations are solved iterably, starting from an initial guess for $U$. 
This guess can be used to compute the density matrix, 
$D^(k) = \sum_i u_i^{(k)}(u_i^{(k)})^*$, where $k$ denotes the iteration. The density 
matrix is used to compute the Fock matrix. This provides us with a general eigenvalue 
problem, from which a new $U$ and $\epsilon$ can be found. This formula is then repeated
until the the iterations converge. At this point we say that we have self-consitency 
in the mean field, and this method is usually called the method of self-constistent
field (SCF) iterations.

\section{[UNFINISHED] Restricted Hartree-Fock Theory}

\section{[UNFINISHED] Unrestricted Hartree-Fock Theory}