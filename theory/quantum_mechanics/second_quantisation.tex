\chapter{Second Quantisation}

Some Slater determinant is written,
\begin{equation}
    \ket{\Phi} = \ket{\phi_i \phi_j \phi_k \dots \phi_z} = \ket{ijk \dots z}.
\end{equation}

\section{Creation and Annihilation Operators}

    The notation of creation and annihilation operators vary,
    \begin{align*}
        \text{creation operator for spinorbital } \phi_i, &\ 
        \hat{X}_i^\dagger, \hat{a}^\dagger_i, \hat{c}_i^\dagger, \hat{i}^\dagger; \\
        \text{annihilation operator for spinorbital } \phi_i, &\ 
        \hat{X}_i, \hat{a}_i, \hat{c}_i, \hat{i}.       
    \end{align*}
    Herein, $\hat{a}_i^\dagger$, $\hat{a}_i$ is used and, if there is no change of 
    confusion, $\hat{i}^\dagger$, $\hat{i}$.

    \paragraph{The Creation Operator}. For every single-particle index $q$,
    we define the creation operator
    $c_q^\dagger$ acting on the vacuum state by
    \begin{equation}
        \hat{a}_i^\dagger \ket{0} = \ket{q}.
    \end{equation}

    For any slater determinant with $N > 0$, the action is defined by
    \begin{align}
        \hat{a}_i^\dagger\ket{jk \dots z} &= \ket{ijk \dots z}, \\
        \hat{a}_i^\dagger\ket{ijk \dots z} &= 0
    \end{align}

    \paragraph{The Annihilation Operator}. It i sufficient to state that the 
    annihilation $c_i$ operator is the hermitian adjoint of the creation operator
    $\hat{c}_i$, but to specify we have
    \begin{equation}
        \hat{a}_i\ket{0} = 0,
    \end{equation}
    as there is no particle in the vacuum state to annihilate. 

    For any arbitrary Slater determinant, we have 
    \begin{align}
        \hat{a}_i \ket{ijk \dots z} &= \ket{ij \dots z}, \\
        \hat{a}_i \ket{jk \dots z} &= 0       
    \end{align}

    SOMETHING MORE ABOUT THE DIFFERENT PERMUTATIONS.

    We can now build a Slater determinant as the result of successive operation of
    several creation operators $\hat{a}_q^\dagger$ on the vacuum state,
    \begin{equation}
        \label{eq:creation_annihilation_slater}
        \hat{a}^\dagger_i \hat{a}^\dagger_j \hat{a}^\dagger_k \dots \hat{a}^\dagger_z
        \ket{0} = \ket{ijk \dots z}.
    \end{equation}

    It is convenient to arrange the spinorbitals in a Slater determinant in
    alphabetical order, as in \autoref{eq:creation_annihilation_slater}. This 
    makes it necessary to ascertain the effects a creation or annihilation
    operator will have on a Slater determinant when the affected orbital is
    not at the beginning of the string of orbitals in the Slater determinant.
    Generally we have,
    \begin{equation}
        \hat{P} \ket{ijk \dots z} = (-1)^{\sigma(\hat{P})} \ket{ijk \dots z},
    \end{equation}
    where $\hat{P}$ permutes the string of orbitals and $\sigma(\hat{P})$ is the
    parity of the permutation $\hat{P}$. we have
    \begin{align}
        \hat{a}_p^\dagger \ket{ijk \dots z} &= 
            (-1)^{\eta_p} \ket{ijk \dots p \dots z}, \\
        \hat{a}_p \ket{ijk \dots p \dots z} &=
            (-1)^{\eta_p} \ket{ijk \dots z},
    \end{align}
    where $\eta_p$ is the number of orbitals preceeding the orbital $\phi_p$, pertaining
    to the creation (annihilation) operator, in the Slater determinant.

\section{Anticommutator Relations}

    Consider some creation operators acting on a Slater determinant,
    \begin{equation}
        \begin{aligned}
            \hat{a}_p^\dagger \hat{a}_q^\dagger \ket{ijk \dots} &= \ket{pqijk \dots} \\
            \hat{a}_q^\dagger \hat{a}_p^\dagger \ket{ijk \dots} &= \ket{qpijk \dots}
                = - \ket{pqijk \dots}.
        \end{aligned}
    \end{equation}
    We demand that these two opartions be equivalent, or that 
    \begin{equation}
        \begin{aligned}
            \hat{a}_p^\dagger \hat{a}_q^\dagger &= 
                -\hat{a}_q^\dagger \hat{a}_p^\dagger \\
            \{\hat{a}_p^\dagger, \hat{a}_q^\dagger\} &\equiv 
                \hat{a}_p^\dagger \hat{a}_q^\dagger + 
                \hat{a}_q^\dagger \hat{a}_p^\dagger = \hat{0}.
        \end{aligned}
    \end{equation}
    This is one of several important anti-commutator relations for creation and
    annihilation operators.

    Similarly, for annihilation operators we have
    \begin{equation}
        \begin{aligned}
            \hat{a}_p \hat{a}_q \ket{qpijk \dots} &= 
                \hat{a}_p\ket{pijk \dots} = \ket{ijk \dots} \\
            \hat{a}_q \hat{a}_p \ket{qpijk \dots} &= 
                - \hat{a}_q \hat{a}_p \ket{pqijk \dots} = 
                - \hat{a}_q \ket{qijk \dots} = - \ket{ijk \dots}.
        \end{aligned}
    \end{equation}
    These two operations must also be equivalent, 
    \begin{equation}
        \begin{aligned}
            \hat{a}_p \hat{a}_q &= 
                -\hat{a}_q \hat{a}_p \\
            \{\hat{a}_p, \hat{a}_q\} &\equiv 
                \hat{a}_p \hat{a}_q + 
                \hat{a}_q \hat{a}_p = \hat{0}.
        \end{aligned}
    \end{equation}

    One case remains, when a creation operator and an annihilation operator is
    applied together on a Slater determinant,
    \begin{equation}
        \hat{a}_p^\dagger \hat{a}_q \ket{qijk \dots} 
            = \hat{a}_p^\dagger \ket{ijk \dots}
            = \ket{pijk \dots}.
    \end{equation}
    This operation will replace $\phi_q$ by $\phi_p$ even if $\phi_p$ would have
    been somewhere else in the interior of the Slater determinant. Any sign change
    as an effect of moving the orbital to the front of the string would be negated
    when the orbital is moved back to the original position. Exchanging the order
    of the operators however,
    \begin{equation}
        \hat{a}_q \hat{a}_p^\dagger \ket{qijk \dots} 
            = \hat{a}_q \ket{pqijk \dots} 
            = -\hat{a}_q \ket{qpijk \dots}
            = -\ket{pijk \dots}.
    \end{equation}
    We again see a sign change and have,
    \begin{equation}
        \{\hat{a}_p^\dagger, \hat{a}_q\} = \hat{0} \quad (p \neq q).
    \end{equation}
    If, on the other hand, $p=q$ we have 
    \begin{equation}
        \begin{aligned}
            \hat{a}_p^\dagger \hat{a}_p \ket{pijk \dots} &= \ket{pijk \dots}, \\
            \hat{a}_p \hat{a}_p^\dagger \ket{pijk \dots} &= 0,
        \end{aligned}
    \end{equation}
    and if the orbital $\phi_p$ in question does not appear in the Slater 
    determinant,
    \begin{equation}
        \begin{aligned}
            \hat{a}_p^\dagger \hat{a}_p \ket{ijk \dots} &= 0, \\
            \hat{a}_p \hat{a}_p^\dagger \ket{ijk \dots} &= 
                \hat{a}_p\ket{pijk \dots} = \ket{ijk \dots}.           
        \end{aligned}
    \end{equation} 
    For all cases we have that,
    \begin{equation}
        \left(\hat{a}_p^\dagger \hat{a}_p + \hat{a}_p \hat{a}_p^\dagger \right)
        \ket{\dots} = \ket{\dots},
    \end{equation}
    or
    \begin{equation}
        \{\hat{a}_p^\dagger, \hat{a}_p\} = \{\hat{a}_p, \hat{a}_p^\dagger\} = \hat{1}.
    \end{equation}
    In conclusion, the anti-commutator relations of the creation and annihilation
    operators are,
    \begin{align}
        \{\hat{a}_p, \hat{a}_q\} &= \hat{0}, \\
        \{\hat{a}_p^\dagger, \hat{a}_q^\dagger\} &= \hat{0}, \\
        \{\hat{a}_p^\dagger, \hat{a}_q\} &= \{\hat{a}_p, \hat{a}_q^\dagger\} 
         = \hat{\delta}_{pq}.
    \end{align}

\section{Representation of Operators}
    
    A second-qunatised one-body operator is written like
    \begin{equation}
        \label{eq:one_body_operator}
        \hat{h} = \sum_{i=1}^N \hat{h}(i) 
        = \sum_{ij} \bra{i} \hat{h} \ket{j}\hat{a}_i^\dagger \hat{a}_j,
    \end{equation}
    where in general, $\bra{p} \hat{h} \ket{q}$ is the matrix element of the single-particle
    operator $\hat{h}$ in a given one-particle basis,
    \begin{equation}
        \bra{p} \hat{h} \ket{q} = \int dx \phi_p(x)^* \hat{h} \phi_q(x).
    \end{equation}
    More accurately, we see from \autoref{eq:one_body_operator}, that $\hat{h}$
    weighs each occupied orbital of a Slater determinant with the appropriate 
    matrix element. 

    A second-quantised two-body operator is written like
    \begin{equation}
        \hat{w} = \sum_{i, j}^N\hat{w}(i,j) 
        = \frac{1}{2} \sum_{ijkl} \bra{ij}\hat{w}\ket{kl} 
            \hat{a}_i^\dagger \hat{a}_j^\dagger \hat{a}_l \hat{a}_k
        = \frac{1}{4} \sum_{ijkl} \bra{ij}  \ket{kl} 
            \hat{a}_i^\dagger \hat{a}_j^\dagger \hat{a}_l \hat{a}_k,
    \end{equation}
    where 
    \begin{equation}
        \bra{ij}\hat{w} \ket{kl} \equiv \bra{i(1)j(2)} \hat{w}_{12} \ket{k(1)l(2)}
    \end{equation} 
    and the antisymmetric two-eletron integral for $\hat{u}$ is abreviated,
    \begin{equation}
        \bra{ij} \hat{w}\ket{kl} - \bra{ij}\hat{w} \ket{kl} 
        = \bra{ij}\hat{w} \ket{kl} \equiv \bra{ij} \ket{kl}.
    \end{equation}
    Similarly to the one-particle operator, the two-particle operator assigns
    the correct matrix element to pairs of single particle functions.

    The second-quantised Hamiltonian can therefore be written,
    \begin{equation}
        \label{eq:second_quant_hamiltionian}
        \hat{H} = \hat{h} + \hat{w} 
        = \sum_{ij} \hat{h}_{ij}\hat{a}^\dagger_i \hat{a}_j
            + \frac{1}{4} \bra{ij}\ket{kl} 
            \hat{a}^\dagger_i \hat{a}^\dagger_j \hat{a}_l \hat{a}_k.
    \end{equation}

\section{Normal Order and Wick's Theorem}

    We have built the foundations necessary to describe wavefunctions in terms
    of creation- and annihilation operators as well as a simple way of writing
    a general electronic Hamiltionian in the second-quantised manner. The following
    is a necessety to be able to compute vacuum expectation values 
    ($\bra{-} \hat{A} \hat{B} \dots \ket{-}$) of products of creation- 
    and annihilation operators. Such expectation values are very important for 
    several computational methods, see Harris, Monkhorst and Freeman 
    (1992)\cite{harris1992algebraic}.

        \subsection{Normal ordering and contractions}

        The normal-ordered product of a string of operators $\hat{A_1}$, $\hat{A_2}$,
        $\hat{A_3}$, $\dots$, is defined as the rearranged product of operators such 
        that all the creation operators are the left of all the annihilation
        operators, including a phase factor corresponding to the parity of the
        permutation producing the rearrangent
        \begin{equation} 
            \begin{aligned}
            n[\hat{A}_1\hat{A}_2 \dots \hat{A}_n ]
            &\equiv (-1)^{\abs{\sigma}}
                \hat{A}_{\sigma(1)}\hat{A}_{\sigma(2)} \dots \hat{A}_{\sigma(n)} \\
            &= (-1)^{\sigma(\hat{P})}\hat{P}(\hat{A}_1\hat{A}_2 \dots \hat{A}_n) \\
            &= (-1)^{\abs{\sigma}}
            [\text{creation operators}] \cdot [\text{annihilation operators}] \\
            &= (-1)^{\abs{\sigma}}\hat{a}^\dagger \hat{b}^\dagger \dots \hat{u} \hat{v},
            \end{aligned}
        \end{equation}
        where $\hat{P}$ is a permutation operator actiing on the product of operators, 
        and $\sigma$ is the parity of the permutation. One should bear in mind that this 
        definition is by no means unique. Here are some examples,
        \begin{gather*}
            n[\hat{a}^\dagger \hat{b}] = \hat{a}^\dagger \hat{b} \quad
            n[\hat{b} \hat{a}^\dagger] = -\hat{a}^\dagger \hat{b} \\
            n[\hat{a} \hat{b} ] = \hat{a} \hat{b} = - \hat{b} \hat{a} \\
            n[\hat{a}^\dagger\hat{b}^\dagger ]
                = \hat{a}^\dagger \hat{b}^\dagger 
                = -\hat{b}^\dagger \hat{a}^\dagger \\
            n[\hat{a}^\dagger \hat{b} \hat{c}^\dagger \hat{d}]
                = -\hat{a}^\dagger \hat{c}^\dagger\hat{b} \hat{d} 
                = \hat{c}^\dagger \hat{a}^\dagger\hat{b} \hat{d} 
                = \hat{a}^\dagger \hat{c}^\dagger\hat{d} \hat{b} 
                = -\hat{c}^\dagger \hat{a}^\dagger\hat{d} \hat{b}.
        \end{gather*}
        Note that the second quantised Hamiltonian in \autoref{eq:second_quant_hamiltionian}
        is already on normal-ordered form.

        For two arbitrary creation and annihilation operators, we define their contraction
        as 
        \begin{equation}
            \wick{\c {\hat{A}} \c {\hat{B}} } \equiv \bra{-} \hat{A} \hat{B}\ket{-},
        \end{equation}
        equivalently,
        \begin{equation}
            \wick{\c {\hat{A}} \c {\hat{B}} } \equiv \hat{A}\hat{B} - n[\hat{A} \hat{B}].
        \end{equation}
        For a creation- and annihilation operator there are four possible contractions,
        \begin{equation}
            \begin{aligned}
            \wick{\c{\hat{a}^\dagger} \c{\hat{b}^\dagger}} 
            &= \bra{-}\hat{a}^\dagger \hat{b}^\dagger \ket{-}
            = \hat{a}^\dagger \hat{b}^\dagger - n[\hat{a}^\dagger \hat{b}^\dagger]
            = 0 \\
            \wick{\c{\hat{a}} \c{\hat{b}}} 
            &= \bra{-}\hat{a} \hat{b} \ket{-}
            = \hat{a} \hat{b} - n[\hat{a} \hat{b}]
            = 0 \\
            \wick{\c{\hat{a}^\dagger} \c{\hat{b}}} 
            &= \bra{-}\hat{a}^\dagger \hat{b} \ket{-}
            = \hat{a}^\dagger \hat{b} - n[\hat{a}^\dagger \hat{b}]
            = 0 \\
            \wick{\c{\hat{a}} \c{\hat{b}^\dagger}} 
            &= \bra{-}\hat{a} \hat{b}^\dagger \ket{-}
            = \hat{a} \hat{b}^\dagger - n[\hat{a} \hat{b}^\dagger]
            = \hat{a} \hat{b}^\dagger - (- \hat{b}^\dagger\hat{a})
            = \{\hat{a}, \hat{b}^\dagger \} = \delta_{ab}.
            \end{aligned}
        \end{equation}
        We see that all contractions between creation- and annihilation operators
        are a number, most of them are zero and only those with a annihilation operator
        to the left and a creation operator to the right can be one.
       
		Contrations inside a normal ordered product is definded as follows,
		\begin{equation}
			n[\hat{A}\hat{B}\hat{C} \dots 
			\wick{\c1{\hat{R}} \dots \c2{\hat{S}} \dots 
					\c1{\hat{T}} \dots \c2{\hat{U}} \dots}]
			= (-1)^{\sigma} \wick{\c1{\hat{R}} \c1{\hat{T}} \c2{\hat{S}} \c2{\hat{U}}}
				\dots n[\hat{A}\hat{B}\hat{C}\dots],
		\end{equation}
		where all contracted operator pairs are moved to the front of the normal ordered 
		product, and $\sigma$ is the parity of the permutations required for this relocation.
		The result will be zero, or plus or minus the normal ordred product without the
		contracted operator pairs.

	\subsection{Wick's Theorem}
		Wick's theorem states that every string of creation and annihilation operators can
		be written as a sum of normal-ordered products with all possible contractions,
	
		\begin{equation}
			\begin{aligned}
			\hat{A}\hat{B}\hat{C}\hat{D}\dots
			=&n[\hat{A}\hat{B}\hat{C}\hat{D}\dots]
			+ n[\wick{\c{\hat{A}}\c{\hat{B}}\hat{C}\hat{D}}\dots]
			+ n[\wick{\c{\hat{A}}\hat{B}\c{\hat{C}}\hat{D}}\dots]
			+ n[\wick{\c{\hat{A}}\hat{B}\hat{C}\c{\hat{D}}}\dots] \\
			&+ \dots
			+ n[\wick{{\hat{A}}\c{\hat{B}}\c{\hat{C}}\hat{D}}\dots]
			+ n[\wick{{\hat{A}}\c{\hat{B}}{\hat{C}}\c{\hat{D}}}\dots]
			+ \dots 
			+ n[\wick{{\hat{A}}{\hat{B}}\c{\hat{C}}\c{\hat{D}}}\dots]
			+ \dots + \\
			&+ n[\wick{\c1{\hat{A}}\c1{\hat{B}}\c2{\hat{C}}\c2{\hat{D}}}\dots]
			+ n[\wick{\c1{\hat{A}}\c2{\hat{B}}\c1{\hat{C}}\c2{\hat{D}}}\dots]
			+ n[\wick{\c2{\hat{A}}\c1{\hat{B}}\c1{\hat{C}}\c2{\hat{D}}}\dots]
			+ \dots,
		\end{aligned}
		\end{equation}

		where eventually all possible contractions of one, two pairs etc, are included.

		Especially when computing vacuum expectation values of normal-ordred products is 
		Wick's theorem very important. The reason for this is that each contraction will 
		not contribute to the result, unless it is a fully contracted operator string,
		\begin{equation} 
			\bra{}\hat{A} \dots \hat{B} \dots \hat{C} \dots \hat{D} \dots \ket{}
				= \sum_{\substack{\text{all possible} \\ \text{contractions}}}
				\wick{
				\bra{} n[\c1{\hat{A}} \dots \c2{\hat{B}} \dots 
				\c1{\hat{C}} \dots \c2{\hat{D}} \dots] \ket{}
				}.
		\end{equation}

		Most vacuum expectation values contain operators strings already have substrings
		that are already normal-ordered. This warrants a very useful generalisation of
		Wick's theorem for such strings,
		\begin{equation}
			\begin{aligned}
			n[\hat{A}_1\hat{A}_2 \dots ]
			n[\hat{B}_1\hat{B}_2 \dots ] \dots
			n[\hat{Z}_1\hat{Z}_2 \dots ]
			= n[\hat{A}_1\hat{A}_2\dots:
				\hat{B}_1\hat{B_2}\dots:
				\dots:
				\hat{Z}_1\hat{Z}_2\dots] \\
			+ \sum_{(1)}
				\wick{n[
				\c{\hat{A}}_1\hat{A}_2\dots:
				\c{\hat{B}}_1\hat{B_2}\dots:
				\dots:
				\hat{Z}_1\hat{Z}_2\dots]}
			+ \dots 
			+ \sum_{(n)}
				\wick{n[		
				\hat{A}_1 \c1{\dots} \c2{\dots} \c3{\dots} 
					\c1{\dots} \c2{\ } \c3{\ } \hat{Z}_N
				]},
			\end{aligned}
		\end{equation}
		where we sum over all combinations of contractions that each involce operators 
		from different substrings, starting with one contractions and up to when all
		opertors, or as many as possible, are contracted.

    \subsection{Particle-Hole Formalism}


